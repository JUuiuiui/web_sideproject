<!DOCTYPE html>
<html lang="zh-Hant">
<head>

    <!-- materialize -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    
    <!-- 資料庫 -->
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
      
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(init);
        function GetUrlVar(VarName) 
		{
		  name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
		  var regexS = "[\\?&]" + VarName + "=([^&#]*)";
		  var regex = new RegExp(regexS);
		  var results = regex.exec(window.location.href);
		  if (results == null)
		   	 return "";
		  else
			 return results[1];
		}
		  // 要先取得網址裡的路徑起點終點經緯度參數 
        var n = decodeURIComponent(GetUrlVar('id'));
        var queryStr = "select* where D="+n;


        function init(){
            var url = 'https://docs.google.com/spreadsheets/d/1PspESk8XkwXeomw_ZsPa-Cb3T42aMgODpjI5NvDszbM/gviz/tq?sheet=工作表1';
            var query = new google.visualization.Query(url);
            query.setQuery(queryStr);
            query.send(processSheetsData);
        }
        function processSheetsData(response) {
	        var data = response.getDataTable();
	        var columns = data.getNumberOfColumns();
	        var rows = data.getNumberOfRows();

            var str=' ';
            for (var r=0 ; r<rows ; r++) {
                str+= '  <div class="row">';
                str+= '    <div class="col s12 m6">';
                str+= '      <div class="card">';
                str+= '        <div class="card-image">';
                str+= '          <img src="'+ data.getFormattedValue(r,2) +'">';
                str+= '          <span class="card-title">'+ data.getFormattedValue(r,0) +'</span>';
                str+= '          <a class="btn-floating halfway-fab waves-effect waves-light red"><i class="material-icons">add</i></a>';
                str+= '        </div>';
                str+= '        <div class="card-content">';
                str+= '          <p>'+ data.getFormattedValue(r,1) +'</p>';
                str+= '          <p><a href="B.html?id='+ data.getFormattedValue(r,3) +'">查看詳情</a></p>';
                str+= '        </div>';
                str+= '      </div>';
                str+= '    </div>';
                str+= '  </div>';
            }
            document.getElementById("demo").innerHTML = str;               
        }
    </script>
</head>
<body>
	<div id="demo"></div>
</body>

</html>
  
  
  
  
  
  
  
  
  